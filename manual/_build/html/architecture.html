
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Hyperledger Fabricアーキテクチャ &#8212; Hyperledger Fabric Manual 1.0 ドキュメント</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="ピア追加のおおまかな流れ" href="addPeer.html" />
    <link rel="prev" title="Dockerについて" href="docker.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="addPeer.html" title="ピア追加のおおまかな流れ"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="docker.html" title="Dockerについて"
             accesskey="P">前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Hyperledger Fabric Manual 1.0 ドキュメント</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="hyperledger-fabric">
<h1>Hyperledger Fabricアーキテクチャ<a class="headerlink" href="#hyperledger-fabric" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="line-block">
<div class="line">Hyperledger Fabricは」基本的に」Dockerのコンテナ技術を用いてP2Pネットワークを構成するツールである</div>
<div class="line">Vagrantでも利用可能だが、公式側があまり推奨していない</div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<div class="last line-block">
<div class="line">Hyperledger Fabricにおいて「ピア」や「ノード」というのは、ひとつのDockerコンテナを指す</div>
<div class="line">P2Pネットワークとはコンテナ間のネットワーク</div>
</div>
</div>
<p>まず、ネットワークを構成する様々な役割のピアについて紹介する</p>
<div class="section" id="id1">
<h2>主要登場人物<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>主要な役割を持ったノードについて説明をしていく</p>
<ul class="simple">
<li>Client</li>
<li>CA</li>
<li>Endorser</li>
<li>Orderer</li>
<li>Peers</li>
</ul>
<div class="line-block">
<div class="line"><strong>Client</strong></div>
<div class="line-block">
<div class="line">Clientはここでは操作者を指す</div>
<div class="line">ネットワークに対してトランザクションを要求する人物のこと</div>
</div>
</div>
<div class="line-block">
<div class="line"><strong>CA</strong></div>
<div class="line-block">
<div class="line">認証局のこと</div>
<div class="line">CAにてユーザー登録をしておくことで、トランザクションを要求してきたClientが正しい操作者であるか判断する</div>
<div class="line">Hyperledger Fabricはプライベート・ネットワークを想定しているので、誰彼構わずトランザクションを要求できない</div>
</div>
</div>
<div class="line-block">
<div class="line"><strong>Endorser</strong></div>
<div class="line-block">
<div class="line">CAでもOrdererでもない通常のピア</div>
<div class="line">ネットワーク内でEndorser(承認者)の役割を果たす</div>
<div class="line">何に対する承認かというと、Clientが要求したトランザクションが正しい要求であるかどうかの承認である</div>
</div>
</div>
<div class="line-block">
<div class="line"><strong>Orderer</strong></div>
<div class="line-block">
<div class="line">Endorserによって承認されたトランザクションをアルゴリズムに従って並び替え、ブロックを作成するピア</div>
</div>
</div>
<div class="line-block">
<div class="line"><strong>Peer</strong></div>
<div class="line-block">
<div class="line">通常のピア</div>
<div class="line">各ピアにはチェーンコードとLedger(ブロックチェーンとワールドステート)が存在する</div>
<div class="line">ピア同士はゴシップ・プロトコルという技術を用いて互いの情報を同期していく</div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">ブロックチェーンとは、言い換えればトランザクションの履歴のこと</p>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<div class="last line-block">
<div class="line">ワールドステートとは、ブロックチェーンがトランザクションの履歴であったのに対して、その時点でのデータの状態である</div>
<div class="line">あくまで現在のDBの状態しかわからないので、一つ前のトランザクションなどを知ることはできない</div>
</div>
</div>
<div class="line-block">
<div class="line">各ノードの紹介が済んだが、アーキテクチャ内でどのようにピア同士が関わっていくのか？</div>
<div class="line">それはトランザクションの流れを追うことで明確になる</div>
<div class="line">よって以下ではトランザクションの流れを説明する</div>
</div>
</div>
<div class="section" id="id2">
<h2>トランザクション・フロー<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><strong>概要図</strong></p>
<a class="reference internal image-reference" href="_images/txflow.png"><img alt="_images/txflow.png" src="_images/txflow.png" style="width: 907.8px; height: 391.8px;" /></a>
<a class="reference internal image-reference" href="_images/txflow2.png"><img alt="_images/txflow2.png" src="_images/txflow2.png" style="width: 709.1999999999999px; height: 370.2px;" /></a>
<p>Clientがトランザクションを作成し、ネットワークに対して要求するとまずEndorserに運ばれる</p>
<a class="reference internal image-reference" href="_images/step1.png"><img alt="_images/step1.png" src="_images/step1.png" style="width: 852.0px; height: 240.0px;" /></a>
<p>Endorserでは</p>
<div class="line-block">
<div class="line">1) トランザクション形式が正しいかどうか</div>
<div class="line">2) 既に処理済みのトランザクションではないかどうか(リプレイアタック防止)</div>
<div class="line">3) Clientの署名が正しいかどうか</div>
<div class="line">4) Clientにトランザクションを要求する権限があるかどうか</div>
</div>
<p>を確認する</p>
<p>確認が取れると処理内容をEndorser自身がシュミレートする</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">Endorserは通常ピアなのでチェーンコードとワールドステートを持っているので実行可能</p>
</div>
<div class="line-block">
<div class="line">シュミレートした結果をトランザクションに書き込み承認し、Clientに返す</div>
<div class="line">シュミレート結果を書き込んでいるので、トランザクションが承認されてブロックが全ピアに運ばれた際に各ピアがチェーンコードを実行する必要がない</div>
</div>
<a class="reference internal image-reference" href="_images/step2.png"><img alt="_images/step2.png" src="_images/step2.png" style="width: 852.0px; height: 271.2px;" /></a>
<div class="line-block">
<div class="line">Clientは返されたトランザクションを今度はOrdererに送る</div>
<div class="line">Ordererではトランザクションを受取り、並び替え、ブロックに変えてピアに対して送る</div>
</div>
<a class="reference internal image-reference" href="_images/step4.png"><img alt="_images/step4.png" src="_images/step4.png" style="width: 852.0px; height: 240.0px;" /></a>
<a class="reference internal image-reference" href="_images/step5.png"><img alt="_images/step5.png" src="_images/step5.png" style="width: 852.0px; height: 240.0px;" /></a>
<p>ピアは受け取ったブロックをブロックチェーンに加え、既にシュミレートした際の結果をワールドステートに書き込む</p>
<a class="reference internal image-reference" href="_images/step6.png"><img alt="_images/step6.png" src="_images/step6.png" style="width: 852.0px; height: 240.0px;" /></a>
<p>以上がトランザクションの流れとアーキテクチャの説明になる</p>
</div>
<div class="section" id="id3">
<h2>参考<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="line-block">
<div class="line">より詳細を知りたい方は <a class="reference external" href="http://hyperledger-fabric.readthedocs.io/en/latest/arch-deep-dive.html">公式ドキュメント</a> を参照してほしい</div>
<div class="line">用語も英語からの翻訳なのでそちらも気になる方は <a class="reference external" href="http://hyperledger-fabric.readthedocs.io/en/latest/glossary.html">公式ドキュメントのGlossary</a> を参照</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>前のトピックへ</h4>
  <p class="topless"><a href="docker.html"
                        title="前の章へ">Dockerについて</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="addPeer.html"
                        title="次の章へ">ピア追加のおおまかな流れ</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="検索" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="addPeer.html" title="ピア追加のおおまかな流れ"
             >次へ</a> |</li>
        <li class="right" >
          <a href="docker.html" title="Dockerについて"
             >前へ</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Hyperledger Fabric Manual 1.0 ドキュメント</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, r-tominaga.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5 で生成しました。
    </div>
  </body>
</html>